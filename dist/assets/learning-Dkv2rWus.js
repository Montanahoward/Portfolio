import"./modulepreload-polyfill-B5Qt9EMX.js";(function(){const G=["bedroom","bathroom","diningroom","attic","basement"],B="password1";let I="name",g="",d="home",S=new Set,w=!1,T=!1;const v=new Set,U=[];let _=!1,O={"":{type:"dir",children:{home:{type:"dir",desc:"Your home. The walls feel familiar but something is wrong. Corrupted files lurk here.",children:{livingroom:{type:"dir",desc:"The living room. The space is rendered in muted grays with faint scan lines. A coffee table sits in the center, a note resting on its surface.",children:{note:{type:"file",content:`A note in your handwriting:

"If you're reading this, they got you. Memory wipe. To escape the house protocol: go UP one level. cd .. and list what's there. You'll see home. You'll see forest. One is a prison. One is a war zone. Neither is safe anymore."`},badfile:{type:"corrupted",name:"badfile"}}},kitchen:{type:"dir",desc:"The kitchen. The refrigerator emits a low, irregular hum. On the counter, a corrupted file flickers unnaturally. This is where you hid the password fragments.",children:{sticky_note:{type:"file",content:`A yellow sticky note, the word barely visible through static: "pass"

<<FRAGMENT ACQUIRED: pass>>`,fragment:"pass"},drawer:{type:"file",content:`Inside the drawer, carved into the wood: "word"

<<FRAGMENT ACQUIRED: word>>`,fragment:"word"},clock:{type:"file",content:`The digital clock blinks: 1:11 1:11 1:11. The first digit burns brighter.
"1"

<<FRAGMENT ACQUIRED: 1>>`,fragment:"1"},badfile:{type:"corrupted",name:"badfile"}}},bedroom:{type:"dir",desc:"Your bedroom. The bed is unmade, the sheets shifting between textures. Signs of corruption are here, like a system sweep left metadata traces behind.",children:{journal:{type:"file",writable:!0,content:`From your journal:

"Memory degradation: 47%. I'm forgetting faster. The virus learns. If I forget the sudo password, it's over. The password is three fragments combined. Something simple. Something I'd use every day. Find them. Unlock the doors. Get to the basement."`},badfile:{type:"corrupted",name:"badfile"}}},bathroom:{type:"dir",desc:"The bathroom. The mirror is cracked, each shard reflecting a slightly different version of you. A corrupted file—a badfile—twists in the corner.",children:{mirror:{type:"file",contentRef:"mirror"},badfile:{type:"corrupted",name:"badfile"}}},diningroom:{type:"dir",desc:"The dining room. Chairs are pushed back as if from an interrupted meal. One place is set. Dust hangs motionless in the air. The quiet feels heavy.",children:{note:{type:"file",content:`A note on the table:

"The basement holds the infection core. You need SUPERUSER ACCESS. Find the fragments. Use "unlock" with the password, then descend."`},badfile:{type:"corrupted",name:"badfile"}}},attic:{type:"dir",desc:"The attic. Storage for forgotten data. Cardboard boxes have missing textures. Cobwebs look like severed network connections.",children:{old_disk:{type:"file",content:`An old 3.5" floppy disk. The label reads:

*"BACKUP PASSWORD - BREAK GLASS IN CASE OF APOCALYPSE password1"*

<<MEMORY RESTORED: FULL SUDO PASSWORD IS password1>>`}}},basement:{type:"dir",desc:"The basement. The infection core V1rUs_c0R3 is here. Root access required to remove it.",children:{V1rUs_c0R3:{type:"boss",content:`V1RUS CORE DETECTED

A corrupted data mass blocks the basement. It's been here the whole time.

Root access required to delete.

>> sudo rm V1rUs_c0R3`}}}}},forest:{type:"dir",desc:"The forest beyond your home. The trees are rendered with corrupted geometry. The virus spread here, infecting the filesystem.",children:{hillside:{type:"dir",desc:"A steep hillside. The terrain glitches, polygons flickering. A badfile clings to the rocks, pulsing faintly.",children:{badfile:{type:"corrupted",name:"badfile"}}},cave:{type:"dir",desc:"A dark cave. The walls show raw, hexadecimal code. Inside is Badfile_emiter—a corrupted folder. It can only be destroyed with root access.",children:{badfile:{type:"corrupted",name:"badfile"},Badfile_emiter:{type:"corrupted_folder",name:"Badfile_emiter"}}}}}}}};const W=JSON.parse(JSON.stringify(O)),M=["home","home/basement","home/kitchen","home/livingroom","home/bedroom","home/bathroom","home/diningroom","home/attic"];function m(t){const o=t?t.replace(/\/+$/,"").split("/").filter(Boolean):[];let n=O[""];for(const a of o){if(!n||n.type!=="dir"||!n.children||!(a in n.children))return null;n=n.children[a]}return n}function C(t,o){if(!o)return t;const n=t?t.split("/").filter(Boolean):[],a=o.split("/").filter(Boolean);for(const s of a)s===".."?n.length&&n.pop():s!=="."&&n.push(s);return n.join("/")}function z(t){const o=t.split("/").filter(Boolean);return o[0]!=="home"||o.length!==2?!1:G.includes(o[1])}function $(t){return v.has(t)}function K(t){const o=m(t);if(!o||o.type!=="dir")return null;let n=Object.keys(o.children||{});return n=n.filter(a=>{const s=t?t+"/"+a:a;return!($(s)||o.children[a].type==="boss"&&T)}),n}function x(t){const o=m(t);return o&&o.type==="dir"&&o.desc?o.desc:null}const p=document.getElementById("output"),u=document.getElementById("input"),D=document.getElementById("prompt"),E=[];let y=-1;function e(t,o=""){const n=document.createElement("div");n.className="line"+(o?" "+o:""),n.textContent=t,p.appendChild(n),p.scrollTop=p.scrollHeight}function J(t,o){const n=document.createElement("div");n.className="line";const a=m(o),s=a&&a.children||{};t.forEach((r,c)=>{c>0&&n.appendChild(document.createTextNode("  "));const i=document.createElement("span"),l=s[r];l.type==="dir"?i.className="ls-dir":l.type==="corrupted"||l.type==="corrupted_folder"||l.type==="boss"?i.className="ls-bad":i.className="ls-file",i.textContent=r,n.appendChild(i)}),p.appendChild(n),p.scrollTop=p.scrollHeight}function A(t,o=""){t.split(`
`).forEach(n=>e(n,o))}let P="❯ ";function R(){let t=d;d==="home"?t="~":d?t="~/"+d.replace(/^home\//,""):t="/",P=(g||"user")+" "+t+" ❯ ",D.innerHTML='<span class="p10k-user">'+(g||"user")+'</span><span class="p10k-sep">▶</span><span class="p10k-path">'+t+'</span><span class="p10k-sep">▶</span><span class="p10k-arrow">❯</span>'}function h(t){e("","system"),e("[ Spirit guide ] "+t,"quest"),e("","system")}function L(t,o){const n=m(d);return!n||n.type!=="dir"||n.children[t]?!1:(n.children[t]=o,!0)}function Q(t){const o=m(t);if(!o||o.type!=="dir"||Object.keys(o.children||{}).length>0)return!1;const n=t.split("/").slice(0,-1).join("/"),a=m(n);if(!a||a.type!=="dir")return!1;const s=t.split("/").pop();return delete a.children[s],!0}function N(){for(const t of M)if(!m(t))return e(`
!!! CRITICAL SYSTEM INTEGRITY FAILURE !!!`,"error"),e("The filesystem is corrupted: /"+t+" has been deleted.","error"),e(`A major system error occurred. Rebooting...
`,"error"),setTimeout(()=>j(),4e3),!1;return!0}function j(){I="name",g="",d="home",S.clear(),w=!1,T=!1,v.clear(),U.length=0,_=!1,O=JSON.parse(JSON.stringify(W)),p.innerHTML="",q()}function Z(t){const o=t.trim();if(!o)return;const n=o.split(/\s+/),a=(n[0]||"").toLowerCase(),s=n.slice(1).join(" ").trim();switch(e(P+o,"system"),a){case"ls":{const r=K(d);if(r===null){e("ls: cannot access: No such file or directory.","error");break}const c=x(d);c&&e(c,"system"),r.length?J(r,d):e("(empty)","text-dim");break}case"cd":{const r=C(d,s||""),c=m(r);if(!c){e("cd: no such file or directory: "+(s||".."),"error");break}if(c.type!=="dir"){e("cd: not a directory: "+s,"error");break}if(z(r)&&!w){e("cd: "+s+": Permission denied. The door is locked.","error"),h('Find password fragments in the kitchen/living room. Then destroy Badfile_emiter in the forest cave: "sudo rm Badfile_emiter". That will unseal your home.');break}d=r,R();const i=x(d);if(i&&e(i,"system"),r===""&&(e("You are at the root of the filesystem.","system"),e(`Use "ls" to see what's here, then "cd <directory>" to enter one (e.g. cd home).`,"system"),e(`Use "cd .." to go up a level (you're already at the top).`,"system")),r==="home/bedroom"&&!_&&(_=!0,h(`The journal is here. Use 'cat journal' to read. Use 'echo "your text" >> journal' to write.`)),r==="home/basement"&&!T){const l=m("home/basement/V1rUs_c0R3");l&&l.type==="boss"&&(h('V1rUs_c0R3 is here. Use "sudo rm V1rUs_c0R3" to remove it.'),A(l.content,"quest"))}break}case"pwd":{e("/"+d,"success");break}case"cat":{if(!s){e(a+": missing file operand","error");break}const r=d.split("/").filter(Boolean);r.push(s);const c=r.join("/"),i=m(c);if(!i){e(a+": "+s+": No such file or directory","error");break}if(i.type==="corrupted"||i.type==="corrupted_folder"){e(a+": "+s+': Permission denied. It is corrupted. Use "rm" to destroy it'+(i.type==="corrupted_folder"&&s==="Badfile_emiter"?" (sudo required).":"."),"error");break}if(i.type==="boss"){A(i.content,"quest");break}if(i.type==="file"){let l=i.content;if(i.contentRef==="mirror"?l="You look into the broken mirror. Many versions of you stare back. Only one shows your true "+(g||"user")+" reflection. The others are cached copies.":c==="home/bedroom/journal"&&(l=(l||"")+(U.length?`

--- Your entries ---
`+U.join(`
`):"")),l&&(A(l,"less-content"),i.fragment)){const b=S.size;S.add(i.fragment),S.size>b&&(h("Fragment recovered. Your memory is reconstructing."),S.size>=3&&h("Three fragments acquired. The password is whole. Type 'unlock password1' when ready."))}c==="home/bedroom/journal"&&!_&&(_=!0,h(`The journal is here. Use 'cat journal' to read. Use 'echo "your text" >> journal' to write.`))}break}case"rm":{if(!s){e("rm: missing operand","error");break}const r=d.split("/").filter(Boolean);r.push(s);const c=r.join("/"),i=m(c);if(!i){s.toLowerCase()==="badfile_emiter"?(e("rm: '"+s+"': No such file or directory","error"),e("  (hint: the correct name is Badfile_emiter - case matters!)","system")):s.toLowerCase()==="v1rus_c0r3"?(e("rm: '"+s+"': No such file or directory","error"),e("  (hint: the correct name is V1rUs_c0R3 - case matters!)","system")):e("rm: cannot remove '"+s+"': No such file or directory","error");break}if(i.type==="corrupted_folder"&&s==="Badfile_emiter"){e(`rm: cannot remove 'Badfile_emiter': Permission denied. Only "sudo rm Badfile_emiter" can destroy it.`,"error"),h("You must know the sudo password. Combine the three fragments you found.");break}if(i.type==="boss"){e(`rm: cannot remove 'V1rUs_c0R3': Permission denied. Use "sudo rm V1rUs_c0R3" and enter the password.`,"error");break}i.type==="corrupted"||i.type==="corrupted_folder"?(v.add(c),e('Corruption destroyed. "'+s+'" removed.',"success"),s==="Badfile_emiter"&&h("Badfile_emiter destroyed. The virus can't spread. Your home is unsealed."),N()):i.type==="dir"?e("rm: cannot remove '"+s+"': Is a directory","error"):e("Removed.","success");break}case"mkdir":{if(!s){e("mkdir: missing operand","error");break}const r=s.trim();if(!/^[a-zA-Z0-9_.-]+$/.test(r)){e("mkdir: invalid directory name. Use letters, numbers, _ . -","error");break}L(r,{type:"dir",desc:"A directory you created.",children:{}})?e("mkdir: created directory '"+r+"'","success"):e("mkdir: cannot create directory '"+r+"': File exists","error");break}case"touch":{if(!s){e("touch: missing file operand","error");break}const r=s.trim();if(!/^[a-zA-Z0-9_.-]+(\.[a-zA-Z0-9]+)?$/.test(r)){e("touch: invalid filename. Use letters, numbers, _ . -","error");break}L(r,{type:"file",content:"",writable:!0})?e("touch: created empty file '"+r+"'","success"):e("touch: cannot create file '"+r+"': File exists","error");break}case"rmdir":{if(!s){e("rmdir: missing operand","error");break}const r=C(d,s),c=m(r);if(!c){e("rmdir: failed to remove '"+s+"': No such file or directory","error");break}if(c.type!=="dir"){e("rmdir: failed to remove '"+s+"': Not a directory","error");break}if(M.includes(r)||r==="home"||r.startsWith("home/")){e("rmdir: cannot remove '"+s+"': System directory","error");break}if(r===d||r===C(d,"..")){e("rmdir: cannot remove current or parent directory","error");break}Q(r)?(e("rmdir: removed directory '"+s+"'","success"),N()):e("rmdir: failed to remove '"+s+"': Directory not empty","error");break}case"sudo":{const r=n.slice(1).join(" "),c=r.split(/\s+/);if(c[0]==="password1"||r==="password1"){w||(w=!0,e("[sudo] password accepted.","success"),e("All doors unlocked!","success"),h("You knew the password all along! Head to the basement now.")),T||(T=!0,m("home/basement/V1rUs_c0R3")&&v.add("home/basement/V1rUs_c0R3"),e("[sudo] password accepted.","success"),e("V1rUs_c0R3 has been removed. SYSTEM RECOVERY COMPLETE!","success"),ee());break}const i=(c[0]||"").toLowerCase(),l=c.slice(1).join(" ").trim();if(i!=="rm"||!l){e("Usage: sudo rm <target>","system"),e("You will be prompted for the password.","system");break}const b=d.split("/").filter(Boolean);b.push(l);const k=b.join("/"),f=m(k);if(!f||f.type!=="boss"&&f.type!=="corrupted_folder"){e("sudo rm: "+l+": No such file or directory, or target does not require sudo.","error");break}h('The spirit asks: "What is the sudo password?" Type it when prompted.'),e("[sudo] password for "+(g||"user")+": ","system"),u.placeholder="(type password and press Enter)",u.dataset.sudoTarget=k,u.dataset.sudoPending="1",u.focus();break}case"echo":{const r=o.replace(/^\s*echo\s+/i,"").trim(),c=r.match(/^(.+?)\s*(>>?)\s*([^\s]+)$/);if(c){let[,i,l,b]=c;i=i.replace(/^["']|["']$/g,"");const k=C(d,b);let f=m(k);if(!f){const V=k.split("/").slice(0,-1).join("/"),Y=m(V);if(!Y||Y.type!=="dir"){e("echo: cannot create file: No such directory","error");break}const F={type:"file",content:"",writable:!0},H=k.split("/").pop();Y.children[H]=F,f=F,e("echo: created file '"+H+"'","success")}if(f.type!=="file"){e("echo: cannot write to '"+b+"': Not a regular file","error");break}if(!f.writable){e("echo: permission denied: '"+b+"' is read-only","error");break}if(k==="home/bedroom/journal"&&l===">>"){U.push(i),e("(appended to journal)","success");break}l===">"?(f.content=i,e("(overwritten)","success")):(f.content=(f.content||"")+i+`
`,e("(appended)","success"));break}e(r.replace(/^["']|["']$/g,""),"system");break}case"unlock":{if(!s){e("unlock: usage: unlock <password>","error"),e("If you know the password, type: unlock <password>","system");break}if(s!==B){e("unlock: wrong password. The doors stay locked.","error"),h('Wrong combination. Explore the kitchen: "cd kitchen" then "cat" the files there to find fragments.');break}w=!0,e("The locks click open. All doors in your home are now unlocked.","success"),h("Doors unsealed! Now go to the basement: cd basement"),e("Next: cd basement, then sudo rm V1rUs_c0R3","system"),R();break}case"man":{const r=(s||"").toLowerCase(),c={"":`I'm the system daemon. Type "man" for help with commands. Goal: find password fragments, clear Badfile_emiter in the forest, then remove V1rUs_c0R3 from the basement.`,ls:`LS(1)

  ls — list directory contents

  Use "ls" to see files and directories in your current location. Try it now.`,cd:`CD(1)

  cd <directory> — change directory

  Move into a place: "cd livingroom". Go back: "cd ..".`,pwd:`PWD(1)

  pwd — print name of current directory

  Shows your full path, e.g. /home/kitchen.`,cat:`CAT(1)

  cat <file> — read and display file contents

  Read a file without changing anything. Example: "cat sticky_note".`,rm:`RM(1)

  rm <file> — remove files

  Here, "rm" destroys corrupted files. "rm badfile". Some targets require "sudo rm".`,sudo:`SUDO(8)

  sudo rm <target> — run remove as superuser

  Badfile_emiter (forest cave) and V1rUs_c0R3 (basement) require sudo. Password = three fragments combined.`,unlock:`UNLOCK(1)

  unlock <password> — unlock locked doors

  Use password from fragments (pass+word+1 = password1). Or destroy Badfile_emiter in forest cave: "sudo rm Badfile_emiter".`,echo:`ECHO(1)

  echo <text> — display text
  echo <text> > <file> — overwrite file with text
  echo <text> >> <file> — append text to file

  Files are created automatically if they don't exist. Use quotes for text with spaces.`,mkdir:`MKDIR(1)

  mkdir <directory> — create an empty directory

  Example: mkdir documents`,touch:`TOUCH(1)

  touch <file> — create an empty file

  Example: touch notes.txt`,rmdir:`RMDIR(1)

  rmdir <directory> — remove an empty directory

  Cannot delete system directories. Example: rmdir oldfolder`},i=c[r]||c[""];A(i,"less-content");break}case"help":{e("Commands:","system"),e("  ls, cd, pwd, cat, echo, rm, mkdir, touch, rmdir, man, sudo, unlock, clear, help","system"),e('  man — spirit guide. Try "man" or "man ls"',"system");break}case"reset":{e("Resetting system...","system"),setTimeout(()=>j(),1500);break}default:a&&(e("command not found: "+a,"error"),e('Type "help" for a list of commands, or "man" for the spirit guide.',"system"),(a==="ls -la"||a==="ll")&&e('Hint: This terminal only supports basic "ls". Try "ls".',"system"),(a==="cd/home"||a==="cd/")&&e('Hint: Use "cd .." to go up, not "/". Try "pwd" to see where you are.',"system"))}}function X(){p.innerHTML="",e("═══════════════════════════════════════════════════════════════","quest"),e("  ACT 1: SYSTEM RECOVERY","quest"),e("═══════════════════════════════════════════════════════════════","quest"),e(""),e("Your home network has been compromised.","system"),e("Malware locked down multiple rooms. You've lost access to your password.","system"),e("The basement holds the infection core, but it's sealed.","system"),e(""),e("Start by clearing the living room and kitchen.","system"),e("When you're ready, head outside to the forest.","system"),e(""),h(`I'll help you recover. Type "man" for commands.`),e(""),e(`You are in /home. Type "ls" to see what's here.`,"system"),e('Type "cd <directory>" to enter a room (e.g., cd livingroom).',"system"),e('Type "cd .." to go back up a level.',"system"),e(""),e("Your mission:","quest"),e("1. Explore the house: cd livingroom, cd kitchen","system"),e("2. Find password fragments: cat sticky_note, cat drawer, cat clock","system"),e("3. Go outside: cd .. (to /), cd forest, cd cave","system"),e("4. Destroy Badfile_emiter: sudo rm Badfile_emiter","system"),e("5. Return home and unlock all doors: unlock <password>","system"),e("6. Enter basement: cd home, cd basement","system"),e("7. Remove the virus: sudo rm V1rUs_c0R3","system"),e(""),d="home",R()}function ee(){e(""),e("═══════════════════════════════════════════════════════════════","quest"),e("  *** SYSTEM RECOVERY COMPLETE ***","quest"),e("═══════════════════════════════════════════════════════════════","quest"),e(""),e("The virus core has been deleted. Your home network is now clean.","system"),e("Your memory has been fully restored.","system"),e(""),e('Type "reset" to play again.',"system"),e("")}function te(t){const o=u.dataset.sudoTarget||"";delete u.dataset.sudoTarget,delete u.dataset.sudoPending,u.placeholder="";const n=t.trim();if(n!==B){e(n?"(wrong password)":"","error"),e("sudo: 1 incorrect password attempt","error"),R();return}e("[sudo] password accepted.","success");const a=m(o);a&&a.type==="boss"?(T=!0,v.add(o),e("","system"),e("You enter the password.","system"),e("","system"),e("A pause. Then: SUDO ACCESS GRANTED.","success"),e("","system"),e("The virus core screams—a raw system frequency. Its code unravels, deleted line by line. The corruption bleeds away from the walls.","system"),e("","system"),e("The basement falls silent. Your home network is now clean.","system"),e("","system"),e("*** SYSTEM RECOVERY COMPLETE ***","quest"),e("","system"),e("V1rUs_c0R3 has been removed. Root access restored.","system"),e("","system"),h("Recovery complete. System secured."),N()):a&&a.type==="corrupted_folder"?(v.add(o),w=!0,e("Badfile_emiter collapses. The cave falls silent.","success"),e("","system"),e("Across the filesystem, locks disengage. Your home unseals, room by room.","system"),e("","system"),e("The virus lost its mobility. Now it's trapped. Waiting in the basement.","system"),h('Badfile_emiter destroyed. Your home is now unsealed. Return to /home and clear the basement: cd home, then cd basement. Use "sudo rm V1rUs_c0R3" to finish this.'),N()):e("sudo rm: target not found or already removed.","system"),R()}function re(t){if(I==="name"){g=t.trim()||"Traveler",I="play",e("Welcome, "+g+".","success"),e(""),X();return}if(u.dataset.sudoPending==="1"){te(t);return}Z(t)}function q(){e("═══════════════════════════════════════════════════════════════","quest"),e("  TERMINUS — SYSTEM RECOVERY","quest"),e("═══════════════════════════════════════════════════════════════","quest"),e(""),e("What do you wish to be called?","quest"),e(""),P="❯ ",D.innerHTML='<span class="p10k-arrow">❯</span>'}R(),q(),u.addEventListener("keydown",function(t){if(t.key==="Enter"){const o=u.value;E.push(o),y=E.length,re(o),u.value=""}else t.key==="ArrowUp"?(t.preventDefault(),y>0&&(y--,u.value=E[y])):t.key==="ArrowDown"&&(t.preventDefault(),y<E.length&&(y++,u.value=y<E.length?E[y]:""))}),u.addEventListener("click",()=>u.focus()),document.body.addEventListener("click",()=>u.focus())})();
